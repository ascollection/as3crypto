<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>MonkeyTab.mxml</title>
<link rel="stylesheet" type="text/css" href="../SourceStyles.css"/>
</head>

<body><pre><span class="MXMLProcessing_Instruction">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="MXMLComment">&lt;!--</span><span class="MXMLComment">
/**
 * MonkeyTab
 * 
 * A small UI Component that compare some openSSL 
 * outputs to the output generated by 
 * the algorithms of the AS3 Crypto library.
 * Copyright (c) 2007 Henri Torgemane
 * 
 * See LICENSE.txt for full license information.
 */
</span><span class="MXMLComment">--&gt;</span>
<span class="MXMLComponent_Tag">&lt;mx:VBox</span><span class="MXMLDefault_Text"> xmlns:mx="</span><span class="MXMLString">http://www.adobe.com/2006/mxml</span><span class="MXMLDefault_Text">" 
    label="</span><span class="MXMLString">OpenSSL Monkey</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"
    creationComplete="</span><span class="ActionScriptDefault_Text">init</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
    <span class="MXMLComponent_Tag">&lt;mx:Text</span><span class="MXMLDefault_Text"> width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
        <span class="MXMLComponent_Tag">&lt;mx:htmlText&gt;</span>
        <span class="MXMLDefault_Text">&lt;![CDATA[</span><span class="MXMLDefault_Text">When you press start, this tab will generate random keys, IVs and plain texts for a number of encryption modes.
The encryption and decryption will be performed by an &lt;a href="http://crypto.hurlant.com/openssl.php?view=1"&gt;openSSL 0.9.7a script on hurlant.com&lt;/a&gt;, as well as by this library.
Any discrepancy will be flagged.
The whole thing is pretty slow. You've been warned.
</span><span class="MXMLDefault_Text">]]&gt;</span>
        <span class="MXMLComponent_Tag">&lt;/mx:htmlText&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/mx:Text&gt;</span>
    <span class="MXMLComponent_Tag">&lt;mx:HBox</span><span class="MXMLDefault_Text"> width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">&gt;</span>
        <span class="MXMLComponent_Tag">&lt;mx:Button</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">btn</span><span class="MXMLDefault_Text">" label="</span><span class="MXMLString">Start</span><span class="MXMLDefault_Text">" click="</span><span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
        <span class="MXMLComponent_Tag">&lt;mx:Label</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">summary</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
    <span class="MXMLComponent_Tag">&lt;/mx:HBox&gt;</span>
    <span class="MXMLComponent_Tag">&lt;mx:TextArea</span><span class="MXMLDefault_Text"> id="</span><span class="MXMLString">console</span><span class="MXMLDefault_Text">" width="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" height="</span><span class="MXMLString">100%</span><span class="MXMLDefault_Text">" editable="</span><span class="MXMLString">false</span><span class="MXMLDefault_Text">" fontFamily="</span><span class="MXMLString">Courier New</span><span class="MXMLDefault_Text">"</span><span class="MXMLComponent_Tag">/&gt;</span>
    <span class="MXMLSpecial_Tag">&lt;mx:Script&gt;</span>
        &lt;![CDATA[
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">util</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Hex</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symmetric</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IVMode</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symmetric</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ICipher</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">prng</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Random</span>;
            <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Crypto</span>;
            <span class="ActionScriptComment">// list of cipher types currently shared with the openSSL command line
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cipherList</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span>
                <span class="ActionScriptString">"aes-128-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-128-cfb"</span><span class="ActionScriptOperator">,</span>
<span class="ActionScriptComment">//                "aes-128-cfb8",
</span>                <span class="ActionScriptString">"aes-128-ecb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-128-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-192-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-192-cfb"</span><span class="ActionScriptOperator">,</span>
<span class="ActionScriptComment">//                "aes-192-cfb8",
</span>                <span class="ActionScriptString">"aes-192-ecb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-192-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-256-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-256-cfb"</span><span class="ActionScriptOperator">,</span>
<span class="ActionScriptComment">//                "aes-256-cfb8",
</span>                <span class="ActionScriptString">"aes-256-ecb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes-256-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes128"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes192"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"aes256"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"bf"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"bf-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"bf-cfb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"bf-ecb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"bf-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"blowfish"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-cfb"</span><span class="ActionScriptOperator">,</span>
<span class="ActionScriptComment">//                "des-cfb8",
</span>                <span class="ActionScriptString">"des-ecb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede-cfb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede3"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede3-cbc"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede3-cfb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ede3-ofb"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"des-ofb"</span><span class="ActionScriptOperator">,</span>
<span class="ActionScriptComment">//                "des3", // duplicate of des-ede3-cbc
</span>                <span class="ActionScriptString">"rc4"</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptString">"rc4-40"</span><span class="ActionScriptOperator">,</span>
            <span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">TRIES</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 3;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cipherIndex</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> -1;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tryCount</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">testFailed</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">testCount</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">testTotal</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">*</span> <span class="ActionScriptDefault_Text">TRIES</span> <span class="ActionScriptOperator">*</span> 2;
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cipher</span>:<span class="ActionScriptDefault_Text">ICipher</span>; <span class="ActionScriptComment">// current cipher
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">key</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;  <span class="ActionScriptComment">// current key
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">iv</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;   <span class="ActionScriptComment">// current iv;
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">src</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;  <span class="ActionScriptComment">// copy of the source text
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">text</span>:<span class="ActionScriptDefault_Text">ByteArray</span>; <span class="ActionScriptComment">// current chunk, encrypted or not.
</span>            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rand</span>:<span class="ActionScriptDefault_Text">Random</span>; <span class="ActionScriptComment">// we need a lot of random bytes.
</span>            
            
        
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">console</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">htmlText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">write</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">str</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">console</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">htmlText</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">str</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">str</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">console</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">htmlText</span><span class="ActionScriptOperator">+=</span><span class="ActionScriptDefault_Text">str</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"\n"</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">summarize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">summary</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">htmlText</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'&lt;B&gt;&lt;FONT COLOR="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptOperator">?</span><span class="ActionScriptString">"#7F0000"</span>:<span class="ActionScriptString">"#007F00"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">testCount</span><span class="ActionScriptOperator">-</span><span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"/"</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">testTotal</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" tests passed."</span><span class="ActionScriptOperator">+</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">&gt;</span>0<span class="ActionScriptOperator">?</span><span class="ActionScriptString">" "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" FAILURES!"</span>:<span class="ActionScriptString">""</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"&lt;/FONT&gt;&lt;/B&gt;"</span>;
            <span class="ActionScriptBracket/Brace">}</span>

            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">init</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">rand</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Random</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">start</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">clear</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptOperator">=</span>-1;
                <span class="ActionScriptDefault_Text">tryCount</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptDefault_Text">testCount</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptDefault_Text">nextCipher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">nextCipher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptDefault_Text">tryCount</span> <span class="ActionScriptOperator">=</span> 0;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipherIndex</span> <span class="ActionScriptOperator">==</span> <span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptComment">// done.
</span>                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Done."</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">keyLength</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getKeySize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">key</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
                <span class="ActionScriptDefault_Text">rand</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">keyLength</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">callLater</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextTry</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">nextTry</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tryCount</span><span class="ActionScriptOperator">&gt;=</span><span class="ActionScriptDefault_Text">TRIES</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"Ran "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tryCount</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" tries with "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">nextCipher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">return</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getCipher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">tryCount</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptDefault_Text">iv</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
                <span class="ActionScriptDefault_Text">rand</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iv</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cipher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getBlockSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">IVMode</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ivm</span>:<span class="ActionScriptDefault_Text">IVMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">IVMode</span>;
                    <span class="ActionScriptDefault_Text">ivm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IV</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">iv</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">text</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">len</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">rand</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextByte</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span>1; <span class="ActionScriptComment">// between 1 and 256
</span>                <span class="ActionScriptDefault_Text">rand</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">nextBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">len</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">src</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
                <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">askOpenSSL</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">cipher</span>: <span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">key</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">iv</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iv</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">mode</span>: <span class="ActionScriptString">"e"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">src</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">encResult</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// compute our own result.
</span>                <span class="ActionScriptDefault_Text">cipher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encrypt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">encResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dst</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">URLLoader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
                <span class="ActionScriptComment">// compare dst and data
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">as3</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">as3</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">dst</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;font color="#7F0000"&gt;FAIL! - '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" aka "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cipher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"&lt;/font&gt;"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  KEY="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  IV="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iv</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  MODE=encrypt"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  SRC="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" OpenSSL OUTPUT="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">dst</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" Library OUTPUT="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">as3</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">testCount</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptDefault_Text">summarize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptComment">// ok. decrypt.
</span>                <span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">getCipher</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">IVMode</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">ivm</span>:<span class="ActionScriptDefault_Text">IVMode</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cipher</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">IVMode</span>;
                    <span class="ActionScriptDefault_Text">ivm</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">IV</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">iv</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">position</span><span class="ActionScriptOperator">=</span>0;
                <span class="ActionScriptDefault_Text">src</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">writeBytes</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">askOpenSSL</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">cipher</span>: <span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">key</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">iv</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iv</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">mode</span>: <span class="ActionScriptString">"d"</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">src</span>: <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">}</span><span class="ActionScriptOperator">,</span>
                    <span class="ActionScriptDefault_Text">decResult</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">cipher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">decrypt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">decResult</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">dst</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">URLLoader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">String</span>;
                <span class="ActionScriptComment">// compare dst and data
</span>                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">as3</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">text</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">as3</span><span class="ActionScriptOperator">!=</span><span class="ActionScriptDefault_Text">dst</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;font color="#7F0000"&gt;FAIL! - '</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cipherList</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">cipherIndex</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">" aka "</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cipher</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"&lt;/font&gt;"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  KEY="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  IV="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">iv</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  MODE=decrypt"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"  SRC="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">Hex</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fromArray</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">src</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" OpenSSL OUTPUT="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">dst</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">writeln</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" Library OUTPUT="</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">as3</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">testFailed</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">testCount</span><span class="ActionScriptOperator">++</span>;
                <span class="ActionScriptDefault_Text">summarize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">callLater</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">nextTry</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptComment">////////
</span>            <span class="ActionScriptComment">// Network request to compute something
</span>            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">askOpenSSL</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cb</span>:<span class="ActionScriptDefault_Text">Function</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span>:<span class="ActionScriptDefault_Text">URLLoader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLLoader</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">req</span>:<span class="ActionScriptDefault_Text">URLRequest</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLRequest</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"http://crypto.hurlant.com/openssl.php"</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vars</span>:<span class="ActionScriptDefault_Text">URLVariables</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">URLVariables</span>;
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">key</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">vars</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptDefault_Text">req</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">method</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">URLRequestMethod</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">GET</span>;
                <span class="ActionScriptDefault_Text">req</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">vars</span>;
                <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">cb</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addEventListener</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">COMPLETE</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">closeLoader</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">load</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">req</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">private</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">closeLoader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span>:<span class="ActionScriptDefault_Text">Event</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span> <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">loader</span>:<span class="ActionScriptDefault_Text">URLLoader</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">URLLoader</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">e</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">target</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">loader</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">close</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
        <span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">&gt;</span>
    <span class="MXMLSpecial_Tag">&lt;/mx:Script&gt;</span>    
<span class="MXMLComponent_Tag">&lt;/mx:VBox&gt;</span></pre></body>
</html>
