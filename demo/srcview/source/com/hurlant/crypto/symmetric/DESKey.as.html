<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>DESKey.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptASDoc">/**
 * DESKey
 * 
 * An Actionscript 3 implementation of the Data Encryption Standard (DES)
 * Copyright (c) 2007 Henri Torgemane
 * 
 * Derived from:
 *         The Bouncy Castle Crypto package, 
 *         Copyright (c) 2000-2004 The Legion Of The Bouncy Castle
 *         (http://www.bouncycastle.org)
 * 
 * See LICENSE.txt for full license information.
 */</span>
<span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">crypto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">symmetric</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">ByteArray</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">util</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Hex</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">com</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">hurlant</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">util</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Memory</span>;

    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">DESKey</span> <span class="ActionScriptReserved">implements</span> <span class="ActionScriptDefault_Text">ISymmetricKey</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptASDoc">/**
         * what follows is mainly taken from "Applied Cryptography", by Bruce
         * Schneier, however it also bears great resemblance to Richard
         * Outerbridge's D3DES...
         */</span>
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">Df_Key</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x01<span class="ActionScriptOperator">,</span> 0x23<span class="ActionScriptOperator">,</span> 0x45<span class="ActionScriptOperator">,</span> 0x67<span class="ActionScriptOperator">,</span> 0x89<span class="ActionScriptOperator">,</span> 0xab<span class="ActionScriptOperator">,</span> 0xcd<span class="ActionScriptOperator">,</span> 0xef<span class="ActionScriptOperator">,</span> 0xfe<span class="ActionScriptOperator">,</span> 0xdc<span class="ActionScriptOperator">,</span> 0xba<span class="ActionScriptOperator">,</span> 0x98<span class="ActionScriptOperator">,</span> 0x76<span class="ActionScriptOperator">,</span> 0x54<span class="ActionScriptOperator">,</span> 0x32<span class="ActionScriptOperator">,</span>
                0x10<span class="ActionScriptOperator">,</span> 0x89<span class="ActionScriptOperator">,</span> 0xab<span class="ActionScriptOperator">,</span> 0xcd<span class="ActionScriptOperator">,</span> 0xef<span class="ActionScriptOperator">,</span> 0x01<span class="ActionScriptOperator">,</span> 0x23<span class="ActionScriptOperator">,</span> 0x45<span class="ActionScriptOperator">,</span> 0x67 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">bytebit</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 128<span class="ActionScriptOperator">,</span> 64<span class="ActionScriptOperator">,</span> 32<span class="ActionScriptOperator">,</span> 16<span class="ActionScriptOperator">,</span> 8<span class="ActionScriptOperator">,</span> 4<span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span> 1 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">bigbyte</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x800000<span class="ActionScriptOperator">,</span> 0x400000<span class="ActionScriptOperator">,</span> 0x200000<span class="ActionScriptOperator">,</span> 0x100000<span class="ActionScriptOperator">,</span> 0x80000<span class="ActionScriptOperator">,</span> 0x40000<span class="ActionScriptOperator">,</span> 0x20000<span class="ActionScriptOperator">,</span> 0x10000<span class="ActionScriptOperator">,</span> 0x8000<span class="ActionScriptOperator">,</span>
                0x4000<span class="ActionScriptOperator">,</span> 0x2000<span class="ActionScriptOperator">,</span> 0x1000<span class="ActionScriptOperator">,</span> 0x800<span class="ActionScriptOperator">,</span> 0x400<span class="ActionScriptOperator">,</span> 0x200<span class="ActionScriptOperator">,</span> 0x100<span class="ActionScriptOperator">,</span> 0x80<span class="ActionScriptOperator">,</span> 0x40<span class="ActionScriptOperator">,</span> 0x20<span class="ActionScriptOperator">,</span> 0x10<span class="ActionScriptOperator">,</span> 0x8<span class="ActionScriptOperator">,</span> 0x4<span class="ActionScriptOperator">,</span> 0x2<span class="ActionScriptOperator">,</span> 0x1 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptComment">/*
         * Use the key schedule specified in the Standard (ANSI X3.92-1981).
         */</span>
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">pc1</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 56<span class="ActionScriptOperator">,</span> 48<span class="ActionScriptOperator">,</span> 40<span class="ActionScriptOperator">,</span> 32<span class="ActionScriptOperator">,</span> 24<span class="ActionScriptOperator">,</span> 16<span class="ActionScriptOperator">,</span> 8<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 57<span class="ActionScriptOperator">,</span> 49<span class="ActionScriptOperator">,</span> 41<span class="ActionScriptOperator">,</span> 33<span class="ActionScriptOperator">,</span> 25<span class="ActionScriptOperator">,</span> 17<span class="ActionScriptOperator">,</span> 9<span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> 58<span class="ActionScriptOperator">,</span> 50<span class="ActionScriptOperator">,</span> 42<span class="ActionScriptOperator">,</span> 34<span class="ActionScriptOperator">,</span> 26<span class="ActionScriptOperator">,</span> 18<span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span>
                59<span class="ActionScriptOperator">,</span> 51<span class="ActionScriptOperator">,</span> 43<span class="ActionScriptOperator">,</span> 35<span class="ActionScriptOperator">,</span> 62<span class="ActionScriptOperator">,</span> 54<span class="ActionScriptOperator">,</span> 46<span class="ActionScriptOperator">,</span> 38<span class="ActionScriptOperator">,</span> 30<span class="ActionScriptOperator">,</span> 22<span class="ActionScriptOperator">,</span> 14<span class="ActionScriptOperator">,</span> 6<span class="ActionScriptOperator">,</span> 61<span class="ActionScriptOperator">,</span> 53<span class="ActionScriptOperator">,</span> 45<span class="ActionScriptOperator">,</span> 37<span class="ActionScriptOperator">,</span> 29<span class="ActionScriptOperator">,</span> 21<span class="ActionScriptOperator">,</span> 13<span class="ActionScriptOperator">,</span> 5<span class="ActionScriptOperator">,</span> 60<span class="ActionScriptOperator">,</span> 52<span class="ActionScriptOperator">,</span> 44<span class="ActionScriptOperator">,</span> 36<span class="ActionScriptOperator">,</span> 28<span class="ActionScriptOperator">,</span> 20<span class="ActionScriptOperator">,</span> 12<span class="ActionScriptOperator">,</span>
                4<span class="ActionScriptOperator">,</span> 27<span class="ActionScriptOperator">,</span> 19<span class="ActionScriptOperator">,</span> 11<span class="ActionScriptOperator">,</span> 3 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">totrot</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 1<span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span> 4<span class="ActionScriptOperator">,</span> 6<span class="ActionScriptOperator">,</span> 8<span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> 12<span class="ActionScriptOperator">,</span> 14<span class="ActionScriptOperator">,</span> 15<span class="ActionScriptOperator">,</span> 17<span class="ActionScriptOperator">,</span> 19<span class="ActionScriptOperator">,</span> 21<span class="ActionScriptOperator">,</span> 23<span class="ActionScriptOperator">,</span> 25<span class="ActionScriptOperator">,</span> 27<span class="ActionScriptOperator">,</span> 28 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">pc2</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 13<span class="ActionScriptOperator">,</span> 16<span class="ActionScriptOperator">,</span> 10<span class="ActionScriptOperator">,</span> 23<span class="ActionScriptOperator">,</span> 0<span class="ActionScriptOperator">,</span> 4<span class="ActionScriptOperator">,</span> 2<span class="ActionScriptOperator">,</span> 27<span class="ActionScriptOperator">,</span> 14<span class="ActionScriptOperator">,</span> 5<span class="ActionScriptOperator">,</span> 20<span class="ActionScriptOperator">,</span> 9<span class="ActionScriptOperator">,</span> 22<span class="ActionScriptOperator">,</span> 18<span class="ActionScriptOperator">,</span> 11<span class="ActionScriptOperator">,</span> 3<span class="ActionScriptOperator">,</span> 25<span class="ActionScriptOperator">,</span> 7<span class="ActionScriptOperator">,</span> 15<span class="ActionScriptOperator">,</span> 6<span class="ActionScriptOperator">,</span> 26<span class="ActionScriptOperator">,</span> 19<span class="ActionScriptOperator">,</span> 12<span class="ActionScriptOperator">,</span> 1<span class="ActionScriptOperator">,</span> 40<span class="ActionScriptOperator">,</span>
                51<span class="ActionScriptOperator">,</span> 30<span class="ActionScriptOperator">,</span> 36<span class="ActionScriptOperator">,</span> 46<span class="ActionScriptOperator">,</span> 54<span class="ActionScriptOperator">,</span> 29<span class="ActionScriptOperator">,</span> 39<span class="ActionScriptOperator">,</span> 50<span class="ActionScriptOperator">,</span> 44<span class="ActionScriptOperator">,</span> 32<span class="ActionScriptOperator">,</span> 47<span class="ActionScriptOperator">,</span> 43<span class="ActionScriptOperator">,</span> 48<span class="ActionScriptOperator">,</span> 38<span class="ActionScriptOperator">,</span> 55<span class="ActionScriptOperator">,</span> 33<span class="ActionScriptOperator">,</span> 52<span class="ActionScriptOperator">,</span> 45<span class="ActionScriptOperator">,</span> 41<span class="ActionScriptOperator">,</span> 49<span class="ActionScriptOperator">,</span> 35<span class="ActionScriptOperator">,</span> 28<span class="ActionScriptOperator">,</span> 31 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP1</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x01010400<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00010000<span class="ActionScriptOperator">,</span> 0x01010404<span class="ActionScriptOperator">,</span> 0x01010004<span class="ActionScriptOperator">,</span> 0x00010404<span class="ActionScriptOperator">,</span> 0x00000004<span class="ActionScriptOperator">,</span>
                0x00010000<span class="ActionScriptOperator">,</span> 0x00000400<span class="ActionScriptOperator">,</span> 0x01010400<span class="ActionScriptOperator">,</span> 0x01010404<span class="ActionScriptOperator">,</span> 0x00000400<span class="ActionScriptOperator">,</span> 0x01000404<span class="ActionScriptOperator">,</span> 0x01010004<span class="ActionScriptOperator">,</span> 0x01000000<span class="ActionScriptOperator">,</span> 0x00000004<span class="ActionScriptOperator">,</span>
                0x00000404<span class="ActionScriptOperator">,</span> 0x01000400<span class="ActionScriptOperator">,</span> 0x01000400<span class="ActionScriptOperator">,</span> 0x00010400<span class="ActionScriptOperator">,</span> 0x00010400<span class="ActionScriptOperator">,</span> 0x01010000<span class="ActionScriptOperator">,</span> 0x01010000<span class="ActionScriptOperator">,</span> 0x01000404<span class="ActionScriptOperator">,</span> 0x00010004<span class="ActionScriptOperator">,</span>
                0x01000004<span class="ActionScriptOperator">,</span> 0x01000004<span class="ActionScriptOperator">,</span> 0x00010004<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00000404<span class="ActionScriptOperator">,</span> 0x00010404<span class="ActionScriptOperator">,</span> 0x01000000<span class="ActionScriptOperator">,</span> 0x00010000<span class="ActionScriptOperator">,</span> 0x01010404<span class="ActionScriptOperator">,</span>
                0x00000004<span class="ActionScriptOperator">,</span> 0x01010000<span class="ActionScriptOperator">,</span> 0x01010400<span class="ActionScriptOperator">,</span> 0x01000000<span class="ActionScriptOperator">,</span> 0x01000000<span class="ActionScriptOperator">,</span> 0x00000400<span class="ActionScriptOperator">,</span> 0x01010004<span class="ActionScriptOperator">,</span> 0x00010000<span class="ActionScriptOperator">,</span> 0x00010400<span class="ActionScriptOperator">,</span>
                0x01000004<span class="ActionScriptOperator">,</span> 0x00000400<span class="ActionScriptOperator">,</span> 0x00000004<span class="ActionScriptOperator">,</span> 0x01000404<span class="ActionScriptOperator">,</span> 0x00010404<span class="ActionScriptOperator">,</span> 0x01010404<span class="ActionScriptOperator">,</span> 0x00010004<span class="ActionScriptOperator">,</span> 0x01010000<span class="ActionScriptOperator">,</span> 0x01000404<span class="ActionScriptOperator">,</span>
                0x01000004<span class="ActionScriptOperator">,</span> 0x00000404<span class="ActionScriptOperator">,</span> 0x00010404<span class="ActionScriptOperator">,</span> 0x01010400<span class="ActionScriptOperator">,</span> 0x00000404<span class="ActionScriptOperator">,</span> 0x01000400<span class="ActionScriptOperator">,</span> 0x01000400<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00010004<span class="ActionScriptOperator">,</span>
                0x00010400<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x01010004 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP2</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x80108020<span class="ActionScriptOperator">,</span> 0x80008000<span class="ActionScriptOperator">,</span> 0x00008000<span class="ActionScriptOperator">,</span> 0x00108020<span class="ActionScriptOperator">,</span> 0x00100000<span class="ActionScriptOperator">,</span> 0x00000020<span class="ActionScriptOperator">,</span> 0x80100020<span class="ActionScriptOperator">,</span>
                0x80008020<span class="ActionScriptOperator">,</span> 0x80000020<span class="ActionScriptOperator">,</span> 0x80108020<span class="ActionScriptOperator">,</span> 0x80108000<span class="ActionScriptOperator">,</span> 0x80000000<span class="ActionScriptOperator">,</span> 0x80008000<span class="ActionScriptOperator">,</span> 0x00100000<span class="ActionScriptOperator">,</span> 0x00000020<span class="ActionScriptOperator">,</span> 0x80100020<span class="ActionScriptOperator">,</span>
                0x00108000<span class="ActionScriptOperator">,</span> 0x00100020<span class="ActionScriptOperator">,</span> 0x80008020<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x80000000<span class="ActionScriptOperator">,</span> 0x00008000<span class="ActionScriptOperator">,</span> 0x00108020<span class="ActionScriptOperator">,</span> 0x80100000<span class="ActionScriptOperator">,</span> 0x00100020<span class="ActionScriptOperator">,</span>
                0x80000020<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00108000<span class="ActionScriptOperator">,</span> 0x00008020<span class="ActionScriptOperator">,</span> 0x80108000<span class="ActionScriptOperator">,</span> 0x80100000<span class="ActionScriptOperator">,</span> 0x00008020<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00108020<span class="ActionScriptOperator">,</span>
                0x80100020<span class="ActionScriptOperator">,</span> 0x00100000<span class="ActionScriptOperator">,</span> 0x80008020<span class="ActionScriptOperator">,</span> 0x80100000<span class="ActionScriptOperator">,</span> 0x80108000<span class="ActionScriptOperator">,</span> 0x00008000<span class="ActionScriptOperator">,</span> 0x80100000<span class="ActionScriptOperator">,</span> 0x80008000<span class="ActionScriptOperator">,</span> 0x00000020<span class="ActionScriptOperator">,</span>
                0x80108020<span class="ActionScriptOperator">,</span> 0x00108020<span class="ActionScriptOperator">,</span> 0x00000020<span class="ActionScriptOperator">,</span> 0x00008000<span class="ActionScriptOperator">,</span> 0x80000000<span class="ActionScriptOperator">,</span> 0x00008020<span class="ActionScriptOperator">,</span> 0x80108000<span class="ActionScriptOperator">,</span> 0x00100000<span class="ActionScriptOperator">,</span> 0x80000020<span class="ActionScriptOperator">,</span>
                0x00100020<span class="ActionScriptOperator">,</span> 0x80008020<span class="ActionScriptOperator">,</span> 0x80000020<span class="ActionScriptOperator">,</span> 0x00100020<span class="ActionScriptOperator">,</span> 0x00108000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x80008000<span class="ActionScriptOperator">,</span> 0x00008020<span class="ActionScriptOperator">,</span> 0x80000000<span class="ActionScriptOperator">,</span>
                0x80100020<span class="ActionScriptOperator">,</span> 0x80108020<span class="ActionScriptOperator">,</span> 0x00108000 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP3</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x00000208<span class="ActionScriptOperator">,</span> 0x08020200<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x08020008<span class="ActionScriptOperator">,</span> 0x08000200<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00020208<span class="ActionScriptOperator">,</span>
                0x08000200<span class="ActionScriptOperator">,</span> 0x00020008<span class="ActionScriptOperator">,</span> 0x08000008<span class="ActionScriptOperator">,</span> 0x08000008<span class="ActionScriptOperator">,</span> 0x00020000<span class="ActionScriptOperator">,</span> 0x08020208<span class="ActionScriptOperator">,</span> 0x00020008<span class="ActionScriptOperator">,</span> 0x08020000<span class="ActionScriptOperator">,</span> 0x00000208<span class="ActionScriptOperator">,</span>
                0x08000000<span class="ActionScriptOperator">,</span> 0x00000008<span class="ActionScriptOperator">,</span> 0x08020200<span class="ActionScriptOperator">,</span> 0x00000200<span class="ActionScriptOperator">,</span> 0x00020200<span class="ActionScriptOperator">,</span> 0x08020000<span class="ActionScriptOperator">,</span> 0x08020008<span class="ActionScriptOperator">,</span> 0x00020208<span class="ActionScriptOperator">,</span> 0x08000208<span class="ActionScriptOperator">,</span>
                0x00020200<span class="ActionScriptOperator">,</span> 0x00020000<span class="ActionScriptOperator">,</span> 0x08000208<span class="ActionScriptOperator">,</span> 0x00000008<span class="ActionScriptOperator">,</span> 0x08020208<span class="ActionScriptOperator">,</span> 0x00000200<span class="ActionScriptOperator">,</span> 0x08000000<span class="ActionScriptOperator">,</span> 0x08020200<span class="ActionScriptOperator">,</span> 0x08000000<span class="ActionScriptOperator">,</span>
                0x00020008<span class="ActionScriptOperator">,</span> 0x00000208<span class="ActionScriptOperator">,</span> 0x00020000<span class="ActionScriptOperator">,</span> 0x08020200<span class="ActionScriptOperator">,</span> 0x08000200<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00000200<span class="ActionScriptOperator">,</span> 0x00020008<span class="ActionScriptOperator">,</span> 0x08020208<span class="ActionScriptOperator">,</span>
                0x08000200<span class="ActionScriptOperator">,</span> 0x08000008<span class="ActionScriptOperator">,</span> 0x00000200<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x08020008<span class="ActionScriptOperator">,</span> 0x08000208<span class="ActionScriptOperator">,</span> 0x00020000<span class="ActionScriptOperator">,</span> 0x08000000<span class="ActionScriptOperator">,</span> 0x08020208<span class="ActionScriptOperator">,</span>
                0x00000008<span class="ActionScriptOperator">,</span> 0x00020208<span class="ActionScriptOperator">,</span> 0x00020200<span class="ActionScriptOperator">,</span> 0x08000008<span class="ActionScriptOperator">,</span> 0x08020000<span class="ActionScriptOperator">,</span> 0x08000208<span class="ActionScriptOperator">,</span> 0x00000208<span class="ActionScriptOperator">,</span> 0x08020000<span class="ActionScriptOperator">,</span> 0x00020208<span class="ActionScriptOperator">,</span>
                0x00000008<span class="ActionScriptOperator">,</span> 0x08020008<span class="ActionScriptOperator">,</span> 0x00020200 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP4</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x00802001<span class="ActionScriptOperator">,</span> 0x00002081<span class="ActionScriptOperator">,</span> 0x00002081<span class="ActionScriptOperator">,</span> 0x00000080<span class="ActionScriptOperator">,</span> 0x00802080<span class="ActionScriptOperator">,</span> 0x00800081<span class="ActionScriptOperator">,</span> 0x00800001<span class="ActionScriptOperator">,</span>
                0x00002001<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00802000<span class="ActionScriptOperator">,</span> 0x00802000<span class="ActionScriptOperator">,</span> 0x00802081<span class="ActionScriptOperator">,</span> 0x00000081<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00800080<span class="ActionScriptOperator">,</span> 0x00800001<span class="ActionScriptOperator">,</span>
                0x00000001<span class="ActionScriptOperator">,</span> 0x00002000<span class="ActionScriptOperator">,</span> 0x00800000<span class="ActionScriptOperator">,</span> 0x00802001<span class="ActionScriptOperator">,</span> 0x00000080<span class="ActionScriptOperator">,</span> 0x00800000<span class="ActionScriptOperator">,</span> 0x00002001<span class="ActionScriptOperator">,</span> 0x00002080<span class="ActionScriptOperator">,</span> 0x00800081<span class="ActionScriptOperator">,</span>
                0x00000001<span class="ActionScriptOperator">,</span> 0x00002080<span class="ActionScriptOperator">,</span> 0x00800080<span class="ActionScriptOperator">,</span> 0x00002000<span class="ActionScriptOperator">,</span> 0x00802080<span class="ActionScriptOperator">,</span> 0x00802081<span class="ActionScriptOperator">,</span> 0x00000081<span class="ActionScriptOperator">,</span> 0x00800080<span class="ActionScriptOperator">,</span> 0x00800001<span class="ActionScriptOperator">,</span>
                0x00802000<span class="ActionScriptOperator">,</span> 0x00802081<span class="ActionScriptOperator">,</span> 0x00000081<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00802000<span class="ActionScriptOperator">,</span> 0x00002080<span class="ActionScriptOperator">,</span> 0x00800080<span class="ActionScriptOperator">,</span> 0x00800081<span class="ActionScriptOperator">,</span>
                0x00000001<span class="ActionScriptOperator">,</span> 0x00802001<span class="ActionScriptOperator">,</span> 0x00002081<span class="ActionScriptOperator">,</span> 0x00002081<span class="ActionScriptOperator">,</span> 0x00000080<span class="ActionScriptOperator">,</span> 0x00802081<span class="ActionScriptOperator">,</span> 0x00000081<span class="ActionScriptOperator">,</span> 0x00000001<span class="ActionScriptOperator">,</span> 0x00002000<span class="ActionScriptOperator">,</span>
                0x00800001<span class="ActionScriptOperator">,</span> 0x00002001<span class="ActionScriptOperator">,</span> 0x00802080<span class="ActionScriptOperator">,</span> 0x00800081<span class="ActionScriptOperator">,</span> 0x00002001<span class="ActionScriptOperator">,</span> 0x00002080<span class="ActionScriptOperator">,</span> 0x00800000<span class="ActionScriptOperator">,</span> 0x00802001<span class="ActionScriptOperator">,</span> 0x00000080<span class="ActionScriptOperator">,</span>
                0x00800000<span class="ActionScriptOperator">,</span> 0x00002000<span class="ActionScriptOperator">,</span> 0x00802080 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP5</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x00000100<span class="ActionScriptOperator">,</span> 0x02080100<span class="ActionScriptOperator">,</span> 0x02080000<span class="ActionScriptOperator">,</span> 0x42000100<span class="ActionScriptOperator">,</span> 0x00080000<span class="ActionScriptOperator">,</span> 0x00000100<span class="ActionScriptOperator">,</span> 0x40000000<span class="ActionScriptOperator">,</span>
                0x02080000<span class="ActionScriptOperator">,</span> 0x40080100<span class="ActionScriptOperator">,</span> 0x00080000<span class="ActionScriptOperator">,</span> 0x02000100<span class="ActionScriptOperator">,</span> 0x40080100<span class="ActionScriptOperator">,</span> 0x42000100<span class="ActionScriptOperator">,</span> 0x42080000<span class="ActionScriptOperator">,</span> 0x00080100<span class="ActionScriptOperator">,</span> 0x40000000<span class="ActionScriptOperator">,</span>
                0x02000000<span class="ActionScriptOperator">,</span> 0x40080000<span class="ActionScriptOperator">,</span> 0x40080000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x40000100<span class="ActionScriptOperator">,</span> 0x42080100<span class="ActionScriptOperator">,</span> 0x42080100<span class="ActionScriptOperator">,</span> 0x02000100<span class="ActionScriptOperator">,</span> 0x42080000<span class="ActionScriptOperator">,</span>
                0x40000100<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x42000000<span class="ActionScriptOperator">,</span> 0x02080100<span class="ActionScriptOperator">,</span> 0x02000000<span class="ActionScriptOperator">,</span> 0x42000000<span class="ActionScriptOperator">,</span> 0x00080100<span class="ActionScriptOperator">,</span> 0x00080000<span class="ActionScriptOperator">,</span> 0x42000100<span class="ActionScriptOperator">,</span>
                0x00000100<span class="ActionScriptOperator">,</span> 0x02000000<span class="ActionScriptOperator">,</span> 0x40000000<span class="ActionScriptOperator">,</span> 0x02080000<span class="ActionScriptOperator">,</span> 0x42000100<span class="ActionScriptOperator">,</span> 0x40080100<span class="ActionScriptOperator">,</span> 0x02000100<span class="ActionScriptOperator">,</span> 0x40000000<span class="ActionScriptOperator">,</span> 0x42080000<span class="ActionScriptOperator">,</span>
                0x02080100<span class="ActionScriptOperator">,</span> 0x40080100<span class="ActionScriptOperator">,</span> 0x00000100<span class="ActionScriptOperator">,</span> 0x02000000<span class="ActionScriptOperator">,</span> 0x42080000<span class="ActionScriptOperator">,</span> 0x42080100<span class="ActionScriptOperator">,</span> 0x00080100<span class="ActionScriptOperator">,</span> 0x42000000<span class="ActionScriptOperator">,</span> 0x42080100<span class="ActionScriptOperator">,</span>
                0x02080000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x40080000<span class="ActionScriptOperator">,</span> 0x42000000<span class="ActionScriptOperator">,</span> 0x00080100<span class="ActionScriptOperator">,</span> 0x02000100<span class="ActionScriptOperator">,</span> 0x40000100<span class="ActionScriptOperator">,</span> 0x00080000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span>
                0x40080000<span class="ActionScriptOperator">,</span> 0x02080100<span class="ActionScriptOperator">,</span> 0x40000100 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP6</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x20000010<span class="ActionScriptOperator">,</span> 0x20400000<span class="ActionScriptOperator">,</span> 0x00004000<span class="ActionScriptOperator">,</span> 0x20404010<span class="ActionScriptOperator">,</span> 0x20400000<span class="ActionScriptOperator">,</span> 0x00000010<span class="ActionScriptOperator">,</span> 0x20404010<span class="ActionScriptOperator">,</span>
                0x00400000<span class="ActionScriptOperator">,</span> 0x20004000<span class="ActionScriptOperator">,</span> 0x00404010<span class="ActionScriptOperator">,</span> 0x00400000<span class="ActionScriptOperator">,</span> 0x20000010<span class="ActionScriptOperator">,</span> 0x00400010<span class="ActionScriptOperator">,</span> 0x20004000<span class="ActionScriptOperator">,</span> 0x20000000<span class="ActionScriptOperator">,</span> 0x00004010<span class="ActionScriptOperator">,</span>
                0x00000000<span class="ActionScriptOperator">,</span> 0x00400010<span class="ActionScriptOperator">,</span> 0x20004010<span class="ActionScriptOperator">,</span> 0x00004000<span class="ActionScriptOperator">,</span> 0x00404000<span class="ActionScriptOperator">,</span> 0x20004010<span class="ActionScriptOperator">,</span> 0x00000010<span class="ActionScriptOperator">,</span> 0x20400010<span class="ActionScriptOperator">,</span> 0x20400010<span class="ActionScriptOperator">,</span>
                0x00000000<span class="ActionScriptOperator">,</span> 0x00404010<span class="ActionScriptOperator">,</span> 0x20404000<span class="ActionScriptOperator">,</span> 0x00004010<span class="ActionScriptOperator">,</span> 0x00404000<span class="ActionScriptOperator">,</span> 0x20404000<span class="ActionScriptOperator">,</span> 0x20000000<span class="ActionScriptOperator">,</span> 0x20004000<span class="ActionScriptOperator">,</span> 0x00000010<span class="ActionScriptOperator">,</span>
                0x20400010<span class="ActionScriptOperator">,</span> 0x00404000<span class="ActionScriptOperator">,</span> 0x20404010<span class="ActionScriptOperator">,</span> 0x00400000<span class="ActionScriptOperator">,</span> 0x00004010<span class="ActionScriptOperator">,</span> 0x20000010<span class="ActionScriptOperator">,</span> 0x00400000<span class="ActionScriptOperator">,</span> 0x20004000<span class="ActionScriptOperator">,</span> 0x20000000<span class="ActionScriptOperator">,</span>
                0x00004010<span class="ActionScriptOperator">,</span> 0x20000010<span class="ActionScriptOperator">,</span> 0x20404010<span class="ActionScriptOperator">,</span> 0x00404000<span class="ActionScriptOperator">,</span> 0x20400000<span class="ActionScriptOperator">,</span> 0x00404010<span class="ActionScriptOperator">,</span> 0x20404000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x20400010<span class="ActionScriptOperator">,</span>
                0x00000010<span class="ActionScriptOperator">,</span> 0x00004000<span class="ActionScriptOperator">,</span> 0x20400000<span class="ActionScriptOperator">,</span> 0x00404010<span class="ActionScriptOperator">,</span> 0x00004000<span class="ActionScriptOperator">,</span> 0x00400010<span class="ActionScriptOperator">,</span> 0x20004010<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x20404000<span class="ActionScriptOperator">,</span>
                0x20000000<span class="ActionScriptOperator">,</span> 0x00400010<span class="ActionScriptOperator">,</span> 0x20004010 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP7</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x00200000<span class="ActionScriptOperator">,</span> 0x04200002<span class="ActionScriptOperator">,</span> 0x04000802<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00000800<span class="ActionScriptOperator">,</span> 0x04000802<span class="ActionScriptOperator">,</span> 0x00200802<span class="ActionScriptOperator">,</span>
                0x04200800<span class="ActionScriptOperator">,</span> 0x04200802<span class="ActionScriptOperator">,</span> 0x00200000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x04000002<span class="ActionScriptOperator">,</span> 0x00000002<span class="ActionScriptOperator">,</span> 0x04000000<span class="ActionScriptOperator">,</span> 0x04200002<span class="ActionScriptOperator">,</span> 0x00000802<span class="ActionScriptOperator">,</span>
                0x04000800<span class="ActionScriptOperator">,</span> 0x00200802<span class="ActionScriptOperator">,</span> 0x00200002<span class="ActionScriptOperator">,</span> 0x04000800<span class="ActionScriptOperator">,</span> 0x04000002<span class="ActionScriptOperator">,</span> 0x04200000<span class="ActionScriptOperator">,</span> 0x04200800<span class="ActionScriptOperator">,</span> 0x00200002<span class="ActionScriptOperator">,</span> 0x04200000<span class="ActionScriptOperator">,</span>
                0x00000800<span class="ActionScriptOperator">,</span> 0x00000802<span class="ActionScriptOperator">,</span> 0x04200802<span class="ActionScriptOperator">,</span> 0x00200800<span class="ActionScriptOperator">,</span> 0x00000002<span class="ActionScriptOperator">,</span> 0x04000000<span class="ActionScriptOperator">,</span> 0x00200800<span class="ActionScriptOperator">,</span> 0x04000000<span class="ActionScriptOperator">,</span> 0x00200800<span class="ActionScriptOperator">,</span>
                0x00200000<span class="ActionScriptOperator">,</span> 0x04000802<span class="ActionScriptOperator">,</span> 0x04000802<span class="ActionScriptOperator">,</span> 0x04200002<span class="ActionScriptOperator">,</span> 0x04200002<span class="ActionScriptOperator">,</span> 0x00000002<span class="ActionScriptOperator">,</span> 0x00200002<span class="ActionScriptOperator">,</span> 0x04000000<span class="ActionScriptOperator">,</span> 0x04000800<span class="ActionScriptOperator">,</span>
                0x00200000<span class="ActionScriptOperator">,</span> 0x04200800<span class="ActionScriptOperator">,</span> 0x00000802<span class="ActionScriptOperator">,</span> 0x00200802<span class="ActionScriptOperator">,</span> 0x04200800<span class="ActionScriptOperator">,</span> 0x00000802<span class="ActionScriptOperator">,</span> 0x04000002<span class="ActionScriptOperator">,</span> 0x04200802<span class="ActionScriptOperator">,</span> 0x04200000<span class="ActionScriptOperator">,</span>
                0x00200800<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00000002<span class="ActionScriptOperator">,</span> 0x04200802<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x00200802<span class="ActionScriptOperator">,</span> 0x04200000<span class="ActionScriptOperator">,</span> 0x00000800<span class="ActionScriptOperator">,</span> 0x04000002<span class="ActionScriptOperator">,</span>
                0x04000800<span class="ActionScriptOperator">,</span> 0x00000800<span class="ActionScriptOperator">,</span> 0x00200002 <span class="ActionScriptBracket/Brace">]</span>;
    
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptReserved">const</span> <span class="ActionScriptDefault_Text">SP8</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span> 0x10001040<span class="ActionScriptOperator">,</span> 0x00001000<span class="ActionScriptOperator">,</span> 0x00040000<span class="ActionScriptOperator">,</span> 0x10041040<span class="ActionScriptOperator">,</span> 0x10000000<span class="ActionScriptOperator">,</span> 0x10001040<span class="ActionScriptOperator">,</span> 0x00000040<span class="ActionScriptOperator">,</span>
                0x10000000<span class="ActionScriptOperator">,</span> 0x00040040<span class="ActionScriptOperator">,</span> 0x10040000<span class="ActionScriptOperator">,</span> 0x10041040<span class="ActionScriptOperator">,</span> 0x00041000<span class="ActionScriptOperator">,</span> 0x10041000<span class="ActionScriptOperator">,</span> 0x00041040<span class="ActionScriptOperator">,</span> 0x00001000<span class="ActionScriptOperator">,</span> 0x00000040<span class="ActionScriptOperator">,</span>
                0x10040000<span class="ActionScriptOperator">,</span> 0x10000040<span class="ActionScriptOperator">,</span> 0x10001000<span class="ActionScriptOperator">,</span> 0x00001040<span class="ActionScriptOperator">,</span> 0x00041000<span class="ActionScriptOperator">,</span> 0x00040040<span class="ActionScriptOperator">,</span> 0x10040040<span class="ActionScriptOperator">,</span> 0x10041000<span class="ActionScriptOperator">,</span> 0x00001040<span class="ActionScriptOperator">,</span>
                0x00000000<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x10040040<span class="ActionScriptOperator">,</span> 0x10000040<span class="ActionScriptOperator">,</span> 0x10001000<span class="ActionScriptOperator">,</span> 0x00041040<span class="ActionScriptOperator">,</span> 0x00040000<span class="ActionScriptOperator">,</span> 0x00041040<span class="ActionScriptOperator">,</span> 0x00040000<span class="ActionScriptOperator">,</span>
                0x10041000<span class="ActionScriptOperator">,</span> 0x00001000<span class="ActionScriptOperator">,</span> 0x00000040<span class="ActionScriptOperator">,</span> 0x10040040<span class="ActionScriptOperator">,</span> 0x00001000<span class="ActionScriptOperator">,</span> 0x00041040<span class="ActionScriptOperator">,</span> 0x10001000<span class="ActionScriptOperator">,</span> 0x00000040<span class="ActionScriptOperator">,</span> 0x10000040<span class="ActionScriptOperator">,</span>
                0x10040000<span class="ActionScriptOperator">,</span> 0x10040040<span class="ActionScriptOperator">,</span> 0x10000000<span class="ActionScriptOperator">,</span> 0x00040000<span class="ActionScriptOperator">,</span> 0x10001040<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x10041040<span class="ActionScriptOperator">,</span> 0x00040040<span class="ActionScriptOperator">,</span> 0x10000040<span class="ActionScriptOperator">,</span>
                0x10040000<span class="ActionScriptOperator">,</span> 0x10001000<span class="ActionScriptOperator">,</span> 0x10001040<span class="ActionScriptOperator">,</span> 0x00000000<span class="ActionScriptOperator">,</span> 0x10041040<span class="ActionScriptOperator">,</span> 0x00041000<span class="ActionScriptOperator">,</span> 0x00041000<span class="ActionScriptOperator">,</span> 0x00001040<span class="ActionScriptOperator">,</span> 0x00001040<span class="ActionScriptOperator">,</span>
                0x00040040<span class="ActionScriptOperator">,</span> 0x10000000<span class="ActionScriptOperator">,</span> 0x10041000 <span class="ActionScriptBracket/Brace">]</span>;

    
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">key</span>:<span class="ActionScriptDefault_Text">ByteArray</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">encKey</span>:<span class="ActionScriptDefault_Text">Array</span>;
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">decKey</span>:<span class="ActionScriptDefault_Text">Array</span>;
    

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">DESKey</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">key</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">key</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">encKey</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">generateWorkingKey</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">this</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">decKey</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">generateWorkingKey</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">false</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptOperator">,</span> 0<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>

        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getBlockSize</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">uint</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> 8;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">decrypt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">block</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">desFunc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">decKey</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">block</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">block</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">dispose</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">=</span>0;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">encKey</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">encKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">decKey</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">decKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">encKey</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptDefault_Text">decKey</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">=</span>0;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">&lt;</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;<span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptBracket/Brace">{</span> <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">=</span>0; <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptDefault_Text">key</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">key</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">null</span>;
            <span class="ActionScriptDefault_Text">Memory</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">gc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">encrypt</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">block</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">desFunc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">encKey</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">block</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">block</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">index</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
            
    
        <span class="ActionScriptASDoc">/**
         * generate an integer based working key based on our secret key and what we
         * processing we are planning to do.
         * 
         * Acknowledgements for this routine go to James Gillogly &amp; Phil Karn.
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">generateWorkingKey</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">encrypting</span>:<span class="ActionScriptDefault_Text">Boolean</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">key</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">off</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">Array</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptComment">//int[] newKey = new int[32];
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">newKey</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> [];
            <span class="ActionScriptComment">//boolean[] pc1m = new boolean[56], pcr = new boolean[56];
</span>            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pc1m</span>:<span class="ActionScriptDefault_Text">ByteArray</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">pcr</span>:<span class="ActionScriptDefault_Text">ByteArray</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">ByteArray</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">l</span>:<span class="ActionScriptDefault_Text">uint</span>;
    
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">j</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> 56; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pc1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
    
                <span class="ActionScriptDefault_Text">pc1m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">key</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">off</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 3<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> <span class="ActionScriptDefault_Text">bytebit</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&amp;</span> 07<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> 0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
    
            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> 16; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">m</span>:<span class="ActionScriptDefault_Text">uint</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">n</span>:<span class="ActionScriptDefault_Text">uint</span>;
    
                <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">encrypting</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;&lt;</span> 1;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span>15 <span class="ActionScriptOperator">-</span> <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 1;
                <span class="ActionScriptBracket/Brace">}</span>
    
                <span class="ActionScriptDefault_Text">n</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">m</span> <span class="ActionScriptOperator">+</span> 1;
                <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> 0;
    
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> 28; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">totrot</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&lt;</span> 28<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pc1m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pc1m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">-</span> 28<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
    
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 28; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> 56; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">totrot</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">&lt;</span> 56<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pc1m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">pc1m</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">l</span> <span class="ActionScriptOperator">-</span> 28<span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
    
                <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">&lt;</span> 24; <span class="ActionScriptDefault_Text">j</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pc2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">m</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">bigbyte</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
    
                    <span class="ActionScriptReserved">if</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">pcr</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">pc2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span> <span class="ActionScriptOperator">+</span> 24<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">n</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">bigbyte</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">j</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
    
            <span class="ActionScriptComment">//
</span>            <span class="ActionScriptComment">// store the processed key
</span>            <span class="ActionScriptComment">//
</span>            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">!=</span> 32; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+=</span> 2<span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i1</span>:<span class="ActionScriptDefault_Text">uint</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i2</span>:<span class="ActionScriptDefault_Text">uint</span>;
    
                <span class="ActionScriptDefault_Text">i1</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span>;
    
                <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i1</span> <span class="ActionScriptOperator">&amp;</span> 0x00fc0000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 6<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i1</span> <span class="ActionScriptOperator">&amp;</span> 0x00000fc0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 10<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&amp;</span> 0x00fc0000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 10<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&amp;</span> 0x00000fc0<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 6<span class="ActionScriptBracket/Brace">)</span>;
    
                <span class="ActionScriptDefault_Text">newKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i1</span> <span class="ActionScriptOperator">&amp;</span> 0x0003f000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 12<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i1</span> <span class="ActionScriptOperator">&amp;</span> 0x0000003f<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&amp;</span> 0x0003f000<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 4<span class="ActionScriptBracket/Brace">)</span>
                        <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i2</span> <span class="ActionScriptOperator">&amp;</span> 0x0000003f<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">newKey</span>;
        <span class="ActionScriptBracket/Brace">}</span>
    
        <span class="ActionScriptASDoc">/**
         * the DES engine.
         */</span>
        <span class="ActionScriptReserved">protected</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">desFunc</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">wKey</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">inp</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">inOff</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">out</span>:<span class="ActionScriptDefault_Text">ByteArray</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">outOff</span>:<span class="ActionScriptDefault_Text">uint</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">work</span>:<span class="ActionScriptDefault_Text">uint</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">right</span>:<span class="ActionScriptDefault_Text">uint</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">left</span>:<span class="ActionScriptDefault_Text">uint</span>;
    
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 24;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 8;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
    
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 4<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 24;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 6<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&lt;&lt;</span> 8;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">inp</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">inOff</span> <span class="ActionScriptOperator">+</span> 7<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 4<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x0f0f0f0f;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 4<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x0000ffff;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">left</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x33333333;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">left</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x00ff00ff;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 8<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&lt;&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 31<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xffffffff;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xaaaaaaaa;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&lt;&lt;</span> 1<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 31<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 1<span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xffffffff;

            <span class="ActionScriptReserved">for</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">round</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">round</span> <span class="ActionScriptOperator">&lt;</span> 8; <span class="ActionScriptDefault_Text">round</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fval</span>:<span class="ActionScriptDefault_Text">uint</span>;
    
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&lt;&lt;</span> 28<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">wKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">round</span> <span class="ActionScriptOperator">*</span> 4 <span class="ActionScriptOperator">+</span> 0<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SP7</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP5</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP3</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">wKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">round</span> <span class="ActionScriptOperator">*</span> 4 <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP8</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP6</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP4</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">fval</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&lt;&lt;</span> 28<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">wKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">round</span> <span class="ActionScriptOperator">*</span> 4 <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">SP7</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP5</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP3</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP1</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">wKey</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">round</span> <span class="ActionScriptOperator">*</span> 4 <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP8</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP6</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP4</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">fval</span> <span class="ActionScriptOperator">|=</span> <span class="ActionScriptDefault_Text">SP2</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x3f<span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">fval</span>;
            <span class="ActionScriptBracket/Brace">}</span>
    
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&lt;&lt;</span> 31<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xaaaaaaaa;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&lt;&lt;</span> 31<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">|</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x00ff00ff;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 8<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 2<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">right</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x33333333;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">left</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x0000ffff;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 16<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 4<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">^</span> <span class="ActionScriptDefault_Text">left</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0x0f0f0f0f;
            <span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptDefault_Text">work</span>;
            <span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">^=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">work</span> <span class="ActionScriptOperator">&lt;&lt;</span> 4<span class="ActionScriptBracket/Brace">)</span>;
    
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 0<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">right</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 4<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 24<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 6<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&gt;&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">out</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">outOff</span> <span class="ActionScriptOperator">+</span> 7<span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">left</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">toString</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptString">"des"</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        
        
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
